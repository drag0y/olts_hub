WEB приложение для опроса OLT Huawei и BDCOM, и вывода информации об абонентских терминалах.\
Приложение работает с ОЛТами:\
Huawei MA5600, MA5800 (EPON, GPON).\
BDCOM 33xx, 36xx только EPON.\
Абонентские терминалы поддерживаются только однопортовые, для Huawei поддерживается CATV порт.\
Если портов больше 1, то приложение работать будет, но статус LAN порта будет выводиться некоректно.\
Весь остальной функционал будет работать как надо.


## Установка
Клонировать репозиторий в любую удобную директорию.
Установить необходимые модули из файла requirements.txt.
```
pip install -r requirements.txt
```
Далее переименовать файл-шаблон конфигурации __config_template.py__ в __config.py__.
```commandline
mv config_template.py config.py
```

В файле __config.py__ заполнить все необходимые данные.


В NetBox необходимо создать теги для Epon и Gpon и привязать их к нужным ОЛТам, которые необходимо "опрашивать".\
Так же в NetBox необходимо создать платформу и привзать к ОЛТам.\
По умолчанию в конфигурации, платформы для НетБокса прописаны так:
```commandline
PF_HUAWEI = "Huawei_OLT"
PF_BDCOM = "BDCOM"
```
Это означает, что платформа должна содержать такие слова в названии.\
Например платформа, названная в НетБоксе как "BDCOM(tm) P3310B Software, Version 10.1.0B Build 63244", 
программой определится без проблем, т.к. содержит слово BDCOM.

Перед первым запуском необходимо создать базу данных.\
В корневой директории приложения, необходимо запустить файл __create_db.py__
```commandline
python3 create_db.py
```
В случае успешного выполнения, на консоль будет выведено сообщение "Создана новая база данных:".\
После чего можно запускать приложение.
```commandline
python3 app.py
```

## Если нету NetBox
Если NetBox не используется, то переменной __NETBOX__ необходимо задать значение 2.\
Тогда кнопка "Обновить список ОЛТов" будет заблокирована, и можно добавлять ОЛТы вручную. 
В данный момент WEB формы для этого ещё нету.\
Поэтому ОЛТы нужно будет добавить с помощью SQL запросов, непосредственно в самой базе.\
В ближайшее время планируется реализация формы для ручного добавления ОЛТов.

## Первый запуск
После запуска приложения, откройте в браузере адрес хоста на котором установлено приложение, 
через двоеточие укажите порт, который прописали в __config.py__ (по умолчанию 5000).\
Например:
```commandline
http://192.168.1.20:5000
```
На главной странице, в нижней части нажать кнопку "Обновить список ОЛТов". 
Если настройки NetBox корректные, то черз пару секунд приложение поддянет список ОЛТов из НетБокса. 
И на экран будет выведено сообщение об успешном выполнении.\
Затем нажать кнопку "Опросить ОЛТы".\
Это запустит процесс опроса __ВСЕХ__ ОЛТов в списке.\
В зависимости от количества ОЛТов и зарегистрированных ОНУ, 
этот процесс может занять от нескольких секунд до нескольких минут.\
Здесь нужно дождаться сообщения об успешном опросе.\
Как дальше работать с программой можно почитать в разделе справка.

## Примечание
Изначально приложение создавалось для ОЛТов Huawei, поэтому не весь функционал, 
что доступен для Huawei реализован для BDCOM. Например, пока ещё не доступен вывод состояния всего 
дерева (pon порта) для BDCOM.
