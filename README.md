## OLTs HUB v1.7
WEB приложение для просмотра состояния абонентских оптических терминалов, фирмы Huawei и BDCOM\
Приложение работает с ОЛТами:\
Huawei MA5600, MA5800 (EPON, GPON).\
BDCOM 33xx, 36xx только EPON.\
Абонентские терминалы поддерживаются только однопортовые, для Huawei поддерживается CATV порт.\
Если портов больше 1, то приложение работать будет, но статус LAN порта будет выводиться некоректно.\
Весь остальной функционал будет работать как надо.

<p align="center">
<img src="https://github.com/drag0y/olts_hub/raw/main/static/images/onu-info.png" width="400">
</p>
<p align="center">
<img src="https://github.com/drag0y/olts_hub/raw/main/static/images/tree.png" width="400">
</p>

## Установка
Клонировать репозиторий в любую удобную директорию.
Установить необходимые модули из файла requirements.txt.
```
pip install -r requirements.txt
```
Далее переименовать файл-шаблон конфигурации __env_template.py__ в __.env__.
```commandline
mv env_template.py .env
```

В файле __.env__ заполнить все необходимые данные.

При работе, программа использует snmpwalk. Поэтому, он дожен быть установлен в системе.\
У Ubuntu подобных системах это можно сделать так.
```commandline
sudo apt install snmp
```

## Настройка с NetBox
В NetBox необходимо создать теги для Epon и Gpon и привязать их к нужным ОЛТам, которые необходимо "опрашивать".\
Так же в NetBox необходимо создать платформу и привзать к ОЛТам.\
По умолчанию в конфигурации, платформы для НетБокса прописаны так:
```commandline
PF_HUAWEI = "Huawei_OLT"
PF_BDCOM = "BDCOM"
```
Это означает, что платформа должна содержать такие слова в названии.\
Например платформа, названная в НетБоксе как "BDCOM(tm) P3310B Software, Version 10.1.0B Build 63244", 
программой определится без проблем, т.к. содержит слово BDCOM.


## Если нету NetBox
Если NetBox не используется, то переменной __NETBOX__ в файле конфигурации, необходимо задать значение 2.\
Тогда кнопка "Обновить список ОЛТов" будет выдавать форму для добавления нового ОЛТа.\
В Форме заполнить все данные об ОЛТе и нажать кнопку "добавить".


## Первый запуск
Перед первым запуском необходимо создать базу данных.\
В корневой директории приложения, необходимо запустить файл __create_db.py__
```commandline
python3 create_db.py
```
В случае успешного выполнения, на консоль будет выведено сообщение "Создана новая база данных:".\
Приложение работает с базой sqlite, для её работы, дополнительно устанавливать ничего не требуется. 
База данных представляет из себя файл с базой, в папке instance.\
После чего можно запускать приложение.
```commandline
python3 app.py
```
После запуска приложения, откройте в браузере адрес хоста на котором установлено приложение, 
через двоеточие укажите порт, который прописали в __config.py__ (по умолчанию 5000).\
Например:
```commandline
http://192.168.1.20:5000
```
На главной странице, в нижней части нажать кнопку "Обновить список ОЛТов". 
Если настройки NetBox корректные, то через пару секунд приложение поддянет список ОЛТов из НетБокса. 
И на экран будет выведено сообщение об успешном выполнении.\
Если вы настроили работу без НетБокса, то появится форма для добавления ОЛТа вручную.\
Затем нажать кнопку "Опросить ОЛТы".\
Это запустит процесс опроса __ВСЕХ__ ОЛТов в списке.\
В зависимости от количества ОЛТов и зарегистрированных ОНУ, 
этот процесс может занять от нескольких секунд до нескольких минут.\
Здесь нужно дождаться сообщения об успешном опросе.\
Как дальше работать с программой можно почитать в разделе "справка".
